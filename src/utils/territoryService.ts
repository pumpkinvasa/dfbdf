// Сервис для работы с границами территорий
// В реальном приложении это может быть интеграция с API типа Nominatim или OpenStreetMap

export interface TerritoryBounds {
  name: string;
  type: 'country' | 'state' | 'city';
  coordinates: number[][][];
  bbox: [number, number, number, number];
  parent?: string;
  countryCode?: string;
  stateCode?: string;
}

// Предустановленные границы некоторых территорий
export const TERRITORY_BOUNDARIES: { [key: string]: TerritoryBounds } = {
  // Россия и регионы
  'Россия': {
    name: 'Россия',
    type: 'country',
    countryCode: 'RU',
    bbox: [19.6389, 41.1851, 169.0, 81.2504],
    coordinates: [[
      [19.6389, 41.1851],
      [169.0, 41.1851],
      [169.0, 81.2504],
      [19.6389, 81.2504],
      [19.6389, 41.1851]
    ]]
  },
  
  // Федеральные субъекты России
  'Московская область': {
    name: 'Московская область',
    type: 'state',
    parent: 'Россия',
    countryCode: 'RU',
    stateCode: 'MO',
    bbox: [35.1967, 54.2421, 40.8747, 56.9371],
    coordinates: [[
      [35.1967, 54.2421], [40.8747, 54.2421], [40.8747, 56.9371], [35.1967, 56.9371], [35.1967, 54.2421]
    ]]
  },
  'Ленинградская область': {
    name: 'Ленинградская область',
    type: 'state',
    parent: 'Россия',
    countryCode: 'RU',
    bbox: [27.2347, 58.0311, 33.7844, 61.5525],
    coordinates: [[
      [27.2347, 58.0311], [33.7844, 58.0311], [33.7844, 61.5525], [27.2347, 61.5525], [27.2347, 58.0311]
    ]]
  },
  'Ростовская область': {
    name: 'Ростовская область',
    type: 'state',
    parent: 'Россия',
    countryCode: 'RU',
    bbox: [39.4269, 45.9183, 44.0419, 50.2408],
    coordinates: [[
      [39.4269, 45.9183], [44.0419, 45.9183], [44.0419, 50.2408], [39.4269, 50.2408], [39.4269, 45.9183]
    ]]
  },
  'Краснодарский край': {
    name: 'Краснодарский край',
    type: 'state',
    parent: 'Россия',
    countryCode: 'RU',
    bbox: [37.3269, 43.4683, 41.8269, 46.8683],
    coordinates: [[
      [37.3269, 43.4683], [41.8269, 43.4683], [41.8269, 46.8683], [37.3269, 46.8683], [37.3269, 43.4683]
    ]]
  },
  'Воронежская область': {
    name: 'Воронежская область',
    type: 'state',
    parent: 'Россия',
    countryCode: 'RU',
    bbox: [38.1269, 49.5683, 42.9269, 51.9683],
    coordinates: [[
      [38.1269, 49.5683], [42.9269, 49.5683], [42.9269, 51.9683], [38.1269, 51.9683], [38.1269, 49.5683]
    ]]
  },
  'Белгородская область': {
    name: 'Белгородская область',
    type: 'state',
    parent: 'Россия',
    countryCode: 'RU',
    bbox: [35.2969, 49.9183, 38.9269, 51.1183],
    coordinates: [[
      [35.2969, 49.9183], [38.9269, 49.9183], [38.9269, 51.1183], [35.2969, 51.1183], [35.2969, 49.9183]
    ]]
  },
  'Курская область': {
    name: 'Курская область',
    type: 'state',
    parent: 'Россия',
    countryCode: 'RU',
    bbox: [34.2969, 50.9183, 38.2969, 52.1183],
    coordinates: [[
      [34.2969, 50.9183], [38.2969, 50.9183], [38.2969, 52.1183], [34.2969, 52.1183], [34.2969, 50.9183]
    ]]
  },
  'Брянская область': {
    name: 'Брянская область',
    type: 'state',
    parent: 'Россия',
    countryCode: 'RU',
    bbox: [31.8269, 52.0183, 35.2969, 53.4183],
    coordinates: [[
      [31.8269, 52.0183], [35.2969, 52.0183], [35.2969, 53.4183], [31.8269, 53.4183], [31.8269, 52.0183]
    ]]
  },

  // Города России
  'Москва': {
    name: 'Москва',
    type: 'city',
    parent: 'Московская область',
    countryCode: 'RU',
    bbox: [37.3193, 55.4920, 37.8671, 55.9579],
    coordinates: [[
      [37.3193, 55.5574], [37.8671, 55.4920], [37.8671, 55.9579], [37.3193, 55.9579], [37.3193, 55.5574]
    ]]
  },
  'Санкт-Петербург': {
    name: 'Санкт-Петербург',
    type: 'city',
    parent: 'Ленинградская область',
    countryCode: 'RU',
    bbox: [29.4354, 59.6939, 30.8177, 60.2578],
    coordinates: [[
      [29.4354, 59.6939], [30.8177, 59.6939], [30.8177, 60.2578], [29.4354, 60.2578], [29.4354, 59.6939]
    ]]
  },

  // Украина и области
  'Украина': {
    name: 'Украина',
    type: 'country',
    countryCode: 'UA',
    bbox: [22.1371, 44.3614, 40.2275, 52.3797],
    coordinates: [[
      [22.1371, 44.3614], [40.2275, 44.3614], [40.2275, 52.3797], [22.1371, 52.3797], [22.1371, 44.3614]
    ]]
  },

  // Области Украины
  'Киевская область': {
    name: 'Киевская область',
    type: 'state',
    parent: 'Украина',
    countryCode: 'UA',
    bbox: [29.2371, 49.5614, 31.9371, 51.2614],
    coordinates: [[
      [29.2371, 49.5614], [31.9371, 49.5614], [31.9371, 51.2614], [29.2371, 51.2614], [29.2371, 49.5614]
    ]]
  },
  'Харьковская область': {
    name: 'Харьковская область',
    type: 'state',
    parent: 'Украина',
    countryCode: 'UA',
    bbox: [35.7371, 49.0614, 38.0371, 50.6614],
    coordinates: [[
      [35.7371, 49.0614], [38.0371, 49.0614], [38.0371, 50.6614], [35.7371, 50.6614], [35.7371, 49.0614]
    ]]
  },
  'Львовская область': {
    name: 'Львовская область',
    type: 'state',
    parent: 'Украина',
    countryCode: 'UA',
    bbox: [22.7371, 49.0614, 25.2371, 50.4614],
    coordinates: [[
      [22.7371, 49.0614], [25.2371, 49.0614], [25.2371, 50.4614], [22.7371, 50.4614], [22.7371, 49.0614]
    ]]
  },
  'Одесская область': {
    name: 'Одесская область',
    type: 'state',
    parent: 'Украина',
    countryCode: 'UA',
    bbox: [27.8371, 45.3614, 30.8371, 47.8614],
    coordinates: [[
      [27.8371, 45.3614], [30.8371, 45.3614], [30.8371, 47.8614], [27.8371, 47.8614], [27.8371, 45.3614]
    ]]
  },
  'Днепропетровская область': {
    name: 'Днепропетровская область',
    type: 'state',
    parent: 'Украина',
    countryCode: 'UA',
    bbox: [33.4371, 47.7614, 36.4371, 49.2614],
    coordinates: [[
      [33.4371, 47.7614], [36.4371, 47.7614], [36.4371, 49.2614], [33.4371, 49.2614], [33.4371, 47.7614]
    ]]
  },
  'Донецкая область': {
    name: 'Донецкая область',
    type: 'state',
    parent: 'Украина',
    countryCode: 'UA',
    bbox: [36.2371, 46.9614, 38.8371, 49.1614],
    coordinates: [[
      [36.2371, 46.9614], [38.8371, 46.9614], [38.8371, 49.1614], [36.2371, 49.1614], [36.2371, 46.9614]
    ]]
  },
  'Луганская область': {
    name: 'Луганская область',
    type: 'state',
    parent: 'Украина',
    countryCode: 'UA',
    bbox: [37.9371, 48.1614, 40.2371, 49.9614],
    coordinates: [[
      [37.9371, 48.1614], [40.2371, 48.1614], [40.2371, 49.9614], [37.9371, 49.9614], [37.9371, 48.1614]
    ]]
  },
  'Запорожская область': {
    name: 'Запорожская область',
    type: 'state',
    parent: 'Украина',
    countryCode: 'UA',
    bbox: [34.2371, 46.2614, 36.9371, 48.5614],
    coordinates: [[
      [34.2371, 46.2614], [36.9371, 46.2614], [36.9371, 48.5614], [34.2371, 48.5614], [34.2371, 46.2614]
    ]]
  },
  'Херсонская область': {
    name: 'Херсонская область',
    type: 'state',
    parent: 'Украина',
    countryCode: 'UA',
    bbox: [32.2371, 45.9614, 34.9371, 47.2614],
    coordinates: [[
      [32.2371, 45.9614], [34.9371, 45.9614], [34.9371, 47.2614], [32.2371, 47.2614], [32.2371, 45.9614]
    ]]
  },
  'Полтавская область': {
    name: 'Полтавская область',
    type: 'state',
    parent: 'Украина',
    countryCode: 'UA',
    bbox: [31.9371, 49.0614, 34.8371, 50.7614],
    coordinates: [[
      [31.9371, 49.0614], [34.8371, 49.0614], [34.8371, 50.7614], [31.9371, 50.7614], [31.9371, 49.0614]
    ]]
  },
  'Сумская область': {
    name: 'Сумская область',
    type: 'state',
    parent: 'Украина',
    countryCode: 'UA',
    bbox: [32.4371, 50.2614, 35.2371, 52.0614],
    coordinates: [[
      [32.4371, 50.2614], [35.2371, 50.2614], [35.2371, 52.0614], [32.4371, 52.0614], [32.4371, 50.2614]
    ]]
  },
  'Черниговская область': {
    name: 'Черниговская область',
    type: 'state',
    parent: 'Украина',
    countryCode: 'UA',
    bbox: [30.7371, 51.0614, 33.2371, 52.3614],
    coordinates: [[
      [30.7371, 51.0614], [33.2371, 51.0614], [33.2371, 52.3614], [30.7371, 52.3614], [30.7371, 51.0614]
    ]]
  },
  'Житомирская область': {
    name: 'Житомирская область',
    type: 'state',
    parent: 'Украина',
    countryCode: 'UA',
    bbox: [27.6371, 50.1614, 29.9371, 51.8614],
    coordinates: [[
      [27.6371, 50.1614], [29.9371, 50.1614], [29.9371, 51.8614], [27.6371, 51.8614], [27.6371, 50.1614]
    ]]
  },
  'Винницкая область': {
    name: 'Винницкая область',
    type: 'state',
    parent: 'Украина',
    countryCode: 'UA',
    bbox: [27.6371, 48.6614, 30.1371, 50.2614],
    coordinates: [[
      [27.6371, 48.6614], [30.1371, 48.6614], [30.1371, 50.2614], [27.6371, 50.2614], [27.6371, 48.6614]
    ]]
  },
  'Черкасская область': {
    name: 'Черкасская область',
    type: 'state',
    parent: 'Украина',
    countryCode: 'UA',
    bbox: [30.9371, 48.7614, 32.9371, 50.1614],
    coordinates: [[
      [30.9371, 48.7614], [32.9371, 48.7614], [32.9371, 50.1614], [30.9371, 50.1614], [30.9371, 48.7614]
    ]]
  },
  'Кировоградская область': {
    name: 'Кировоградская область',
    type: 'state',
    parent: 'Украина',
    countryCode: 'UA',
    bbox: [31.2371, 47.4614, 33.7371, 49.4614],
    coordinates: [[
      [31.2371, 47.4614], [33.7371, 47.4614], [33.7371, 49.4614], [31.2371, 49.4614], [31.2371, 47.4614]
    ]]
  },
  'Николаевская область': {
    name: 'Николаевская область',
    type: 'state',
    parent: 'Украина',
    countryCode: 'UA',
    bbox: [30.9371, 46.2614, 33.2371, 47.9614],
    coordinates: [[
      [30.9371, 46.2614], [33.2371, 46.2614], [33.2371, 47.9614], [30.9371, 47.9614], [30.9371, 46.2614]
    ]]
  },
  'Хмельницкая область': {
    name: 'Хмельницкая область',
    type: 'state',
    parent: 'Украина',
    countryCode: 'UA',
    bbox: [25.1371, 48.9614, 27.9371, 50.6614],
    coordinates: [[
      [25.1371, 48.9614], [27.9371, 48.9614], [27.9371, 50.6614], [25.1371, 50.6614], [25.1371, 48.9614]
    ]]
  },
  'Тернопольская область': {
    name: 'Тернопольская область',
    type: 'state',
    parent: 'Украина',
    countryCode: 'UA',
    bbox: [24.8371, 48.8614, 26.6371, 50.0614],
    coordinates: [[
      [24.8371, 48.8614], [26.6371, 48.8614], [26.6371, 50.0614], [24.8371, 50.0614], [24.8371, 48.8614]
    ]]
  },
  'Ровенская область': {
    name: 'Ровенская область',
    type: 'state',
    parent: 'Украина',
    countryCode: 'UA',
    bbox: [24.6371, 50.3614, 27.1371, 51.7614],
    coordinates: [[
      [24.6371, 50.3614], [27.1371, 50.3614], [27.1371, 51.7614], [24.6371, 51.7614], [24.6371, 50.3614]
    ]]
  },
  'Волынская область': {
    name: 'Волынская область',
    type: 'state',
    parent: 'Украина',
    countryCode: 'UA',
    bbox: [22.8371, 50.7614, 25.2371, 52.0614],
    coordinates: [[
      [22.8371, 50.7614], [25.2371, 50.7614], [25.2371, 52.0614], [22.8371, 52.0614], [22.8371, 50.7614]
    ]]
  },
  'Ивано-Франковская область': {
    name: 'Ивано-Франковская область',
    type: 'state',
    parent: 'Украина',
    countryCode: 'UA',
    bbox: [23.5371, 48.0614, 25.9371, 49.3614],
    coordinates: [[
      [23.5371, 48.0614], [25.9371, 48.0614], [25.9371, 49.3614], [23.5371, 49.3614], [23.5371, 48.0614]
    ]]
  },
  'Закарпатская область': {
    name: 'Закарпатская область',
    type: 'state',
    parent: 'Украина',
    countryCode: 'UA',
    bbox: [22.1371, 47.8614, 24.6371, 48.9614],
    coordinates: [[
      [22.1371, 47.8614], [24.6371, 47.8614], [24.6371, 48.9614], [22.1371, 48.9614], [22.1371, 47.8614]
    ]]
  },
  'Черновицкая область': {
    name: 'Черновицкая область',
    type: 'state',
    parent: 'Украина',
    countryCode: 'UA',
    bbox: [25.7371, 47.7614, 26.8371, 48.6614],
    coordinates: [[
      [25.7371, 47.7614], [26.8371, 47.7614], [26.8371, 48.6614], [25.7371, 48.6614], [25.7371, 47.7614]
    ]]
  },

  // Города Украины
  'Киев': {
    name: 'Киев',
    type: 'city',
    parent: 'Киевская область',
    countryCode: 'UA',
    bbox: [30.2371, 50.2614, 30.8371, 50.6614],
    coordinates: [[
      [30.2371, 50.2614], [30.8371, 50.2614], [30.8371, 50.6614], [30.2371, 50.6614], [30.2371, 50.2614]
    ]]
  },
  'Харьков': {
    name: 'Харьков',
    type: 'city',
    parent: 'Харьковская область',
    countryCode: 'UA',
    bbox: [36.1371, 49.8614, 36.4371, 50.1614],
    coordinates: [[
      [36.1371, 49.8614], [36.4371, 49.8614], [36.4371, 50.1614], [36.1371, 50.1614], [36.1371, 49.8614]
    ]]
  },
  'Одесса': {
    name: 'Одесса',
    type: 'city',
    parent: 'Одесская область',
    countryCode: 'UA',
    bbox: [30.6371, 46.3614, 30.9371, 46.6614],
    coordinates: [[
      [30.6371, 46.3614], [30.9371, 46.3614], [30.9371, 46.6614], [30.6371, 46.6614], [30.6371, 46.3614]
    ]]
  },
  'Днепр': {
    name: 'Днепр',
    type: 'city',
    parent: 'Днепропетровская область',
    countryCode: 'UA',
    bbox: [34.8371, 48.3614, 35.2371, 48.6614],
    coordinates: [[
      [34.8371, 48.3614], [35.2371, 48.3614], [35.2371, 48.6614], [34.8371, 48.6614], [34.8371, 48.3614]
    ]]
  },
  'Львов': {
    name: 'Львов',
    type: 'city',
    parent: 'Львовская область',
    countryCode: 'UA',
    bbox: [23.9371, 49.7614, 24.2371, 49.9614],
    coordinates: [[
      [23.9371, 49.7614], [24.2371, 49.7614], [24.2371, 49.9614], [23.9371, 49.9614], [23.9371, 49.7614]
    ]]
  },

  // Другие страны
  'Германия': {
    name: 'Германия',
    type: 'country',
    countryCode: 'DE',
    bbox: [5.8663, 47.2701, 15.0419, 55.0815],
    coordinates: [[
      [5.8663, 47.2701], [15.0419, 47.2701], [15.0419, 55.0815], [5.8663, 55.0815], [5.8663, 47.2701]
    ]]
  },
  'Берлин': {
    name: 'Берлин',
    type: 'city',
    parent: 'Германия',
    countryCode: 'DE',
    bbox: [13.0882, 52.3382, 13.7606, 52.6755],
    coordinates: [[
      [13.0882, 52.3382], [13.7606, 52.3382], [13.7606, 52.6755], [13.0882, 52.6755], [13.0882, 52.3382]
    ]]
  }
};

// Функция для получения границ территории
export const getTerritoryBounds = async (territoryName: string): Promise<TerritoryBounds | null> => {
  // В реальном приложении здесь может быть запрос к API
  return TERRITORY_BOUNDARIES[territoryName] || null;
};

// Функция для поиска территорий
export const searchTerritories = async (query: string): Promise<TerritoryBounds[]> => {
  const normalizedQuery = query.toLowerCase();
  return Object.values(TERRITORY_BOUNDARIES).filter(territory =>
    territory.name.toLowerCase().includes(normalizedQuery) ||
    territory.parent?.toLowerCase().includes(normalizedQuery)
  );
};

// Функция для создания простого прямоугольного полигона из bbox
export const createPolygonFromBbox = (bbox: [number, number, number, number]): number[][] => {
  const [minLon, minLat, maxLon, maxLat] = bbox;
  return [
    [minLon, minLat],
    [maxLon, minLat],
    [maxLon, maxLat],
    [minLon, maxLat],
    [minLon, minLat]
  ];
};
